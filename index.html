<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>AskMe</title>
    <link rel="stylesheet" href="./styles.css" />
    <!-- √çcones Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  </head>

  <body>
    <!-- MENU LATERAL -->
    <nav id="sideMenu" class="side-menu interactive-zone">
      <!-- DRAG HANDLE -->
      <div id="dragHandle" class="menu-header">
        <span class="menu-icon material-icons">open_with</span>
        <span class="menu-item-text none">Drag Handle</span>
      </div>

      <div id="btnToggleClick" class="menu-header">
        <span class="menu-icon material-icons">swipe</span>
        <span class="menu-item-text none">Click-through</span>
      </div>

      <ul class="menu-items">
        <li class="menu-item active" data-tab="home">
          <span class="menu-item-icon material-icons">home</span>
          <span class="menu-item-text none">Inicio</span>
        </li>
        <li class="menu-item" data-tab="api-models">
          <span class="menu-item-icon material-icons">api</span>
          <span class="menu-item-text none">API e Modelos</span>
        </li>
        <li class="menu-item" data-tab="audio-screen">
          <span class="menu-item-icon material-icons">mic</span>
          <span class="menu-item-text none">√Åudio e Tela</span>
        </li>
        <li class="menu-item" data-tab="privacy">
          <span class="menu-item-icon material-icons">security</span>
          <span class="menu-item-text none">Privacidade</span>
        </li>
        <li class="menu-item" data-tab="other">
          <span class="menu-item-icon material-icons">more_horiz</span>
          <span class="menu-item-text none">Outros</span>
        </li>
        <li class="menu-item" data-tab="info">
          <span class="menu-item-icon material-icons">info</span>
          <span class="menu-item-text none">v1.0.0</span>
        </li>
      </ul>

      <div id="btnClose" class="menu-footer danger">
        <span class="menu-item-icon material-icons">power_settings_new</span>
        <span class="menu-item-text none">Sair</span>
      </div>
    </nav>

    <!-- üîù TOP BAR -->
    <div id="topBar">
      <div class="form-group-top">
        <div class="top-bar-title">AskMe</div>

        <div class="interviewMode">
          <!-- Modo (combobox) -->
          <label for="interviewModeSelect">Modo:</label>
          <select id="interviewModeSelect" class="interactive-zone">
            <option value="NORMAL">Padr√£o</option>
            <option value="INTERVIEW" selected>Entrevista</option>
          </select>
        </div>
      </div>

      <!-- MOCK BADGE -->
      <div id="mockBadge" class="mock-badge hidden">üß™ MODO MOCK ATIVADO!!!</div>

      <!-- üì∏ NOVO: SCREENSHOT BADGE -->
      <div id="screenshotBadge" class="screenshot-badge hidden">üì∏ 0 screenshots</div>

      <!-- üîé CONTROLE DE OPACIDADE DO OVERLAY -->
      <div class="opacity-control interactive-zone">
        <input type="range" id="opacityRange" min="0" max="1" step="0.01" value="0.75" />
      </div>
    </div>

    <!-- CONTE√öDO PRINCIPAL -->
    <div id="mainContent">
      <div id="configSections">
        <!-- HOME -->
        <section id="home" class="config-section active">
          <div class="config-form">
            <div class="form-group">
              <!-- Monitoramento de Volume -->

              <div class="home-vu-meters">
                <div class="vu-meter-home">
                  <label for="inputVuHome">üé§ Entrada:</label>
                  <div class="vu-meter">
                    <div id="inputVuHome" class="vu-fill"></div>
                  </div>
                </div>

                <div class="vu-meter-home">
                  <label for="outputVuHome">üîä Sa√≠da:</label>
                  <div class="vu-meter">
                    <div id="outputVuHome" class="vu-fill"></div>
                  </div>
                </div>

                <span id="status">Status: parado</span>

                <!-- üî• BOT√ÉO TEMPOR√ÅRIO: RESET COMPLETO -->
                <button
                  id="resetHomeBtn"
                  class="btn-reset-home"
                  title="Limpa transcri√ß√£o, hist√≥rico e respostas (tempor√°rio para testes)"
                ></button>

                <!-- üì∏ NOVO: Clear Screenshots Button -->
                <button id="clearScreenshotsBtn" class="btn-clear-screenshots">üóëÔ∏è</button>
              </div>
            </div>

            <div class="form-group config-home">
              <!-- PERGUNTAS (ESQUERDA) -->
              <div id="questions">
                <button id="listenBtn" class="btn-activate">Come√ßar a Ouvir... (Ctrl+d)</button>

                <div id="transcriptionContainer">
                  <strong>Transcri√ß√£o</strong>
                  <div id="conversation"></div>
                </div>

                <div class="questions-header">
                  <strong>‚ùî Perguntas Consolidadas</strong>
                </div>

                <div id="currentQuestion">
                  <span id="currentQuestionText"></span>
                </div>

                <div id="questionsHistory"></div>
              </div>

              <!-- RESPOSTAS (DIREITA) -->
              <div id="answers">
                <div class="answers-header">
                  <strong>ü§ñ Respostas LLM</strong>

                  <button id="askLlmBtn" class="btn-ask-llm">
                    <span class="material-icons">forward</span>
                    Gerar resposta (Ctrl+Enter)
                  </button>
                </div>

                <div id="answersHistory"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- API e Modelos -->
        <section id="api-models" class="config-section">
          <h2>
            <span class="material-icons">api</span>
            API e Modelos
          </h2>

          <div class="config-tabs">
            <div class="tab-buttons">
              <button class="tab-button active" data-tab="openai">OpenAI</button>
              <button class="tab-button" data-tab="google">Google</button>
              <button class="tab-button" data-tab="openrouter">OpenRouter</button>
            </div>

            <div class="tab-content">
              <!-- OpenAI Tab -->
              <div id="openai" class="tab-pane active">
                <div class="config-form">
                  <div class="form-group flex space-between">
                    <div>
                      <label for="openai-api-key">Chave da API:</label>
                      <div class="input-with-action">
                        <input
                          type="password"
                          id="openai-api-key"
                          placeholder="Insira sua API key"
                          class="api-key-input"
                          autocomplete="off"
                          data-has-key="false"
                        />
                        <button class="btn-toggle-visibility" data-target="openai-api-key">
                          <span class="material-icons">visibility</span>
                        </button>
                        <!-- üî• NOVO: Bot√£o para deletar API key -->
                        <button
                          class="btn-delete-api-key"
                          data-provider="openai"
                          title="Remover API key"
                        >
                          <span class="material-icons">delete</span>
                        </button>
                      </div>
                      <small>üîí Sua chave √© armazenada de forma criptografada localmente.</small>
                    </div>

                    <div>
                      <label for="openai-model-status">Status do Modelo:</label>
                      <div class="model-status" id="openai-model-status">
                        <span class="status-badge active">Ativo</span>
                        <button class="btn-activate" data-model="openai">Desativar</button>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="openai-stt-model">Modelo de Transcri√ß√£o (STT):</label>
                    <select id="openai-stt-model" class="interactive-zone">
                      <option value="deepgram">Deepgram (Nuvem, Tempo Real)</option>
                      <option value="vosk">Vosk (Local/Offline, R√°pido)</option>
                      <option value="whisper-cpp-local">
                        Whisper.cpp (Local/Offline, Alta Precis√£o)
                      </option>
                    </select>
                    <small
                      >Selecione o modelo para converter √°udio em texto (Speech-to-Text).</small
                    >
                  </div>

                  <div class="form-group">
                    <label for="openai-llm-model">Modelo de Resposta (LLM):</label>
                    <select id="openai-llm-model" class="interactive-zone">
                      <option value="gpt-4o-mini">GPT-4o Mini</option>
                    </select>
                    <small>Selecione o modelo para gerar respostas √†s perguntas.</small>
                  </div>

                  <div class="action-buttons">
                    <button class="btn-save" data-section="openai">
                      <span class="material-icons">save</span>
                      Salvar Configura√ß√µes
                    </button>
                  </div>
                </div>
              </div>

              <!-- Google Tab -->
              <div id="google" class="tab-pane">
                <div class="config-form">
                  <div class="form-group flex space-between">
                    <div>
                      <label for="google-api-key">Chave da API:</label>
                      <div class="input-with-action">
                        <input
                          type="password"
                          id="google-api-key"
                          placeholder="Insira sua API key"
                          class="api-key-input"
                          autocomplete="off"
                          data-has-key="false"
                        />
                        <button class="btn-toggle-visibility" data-target="google-api-key">
                          <span class="material-icons">visibility</span>
                        </button>
                        <!-- üî• NOVO: Bot√£o para deletar API key -->
                        <button
                          class="btn-delete-api-key"
                          data-provider="google"
                          title="Remover API key"
                        >
                          <span class="material-icons">delete</span>
                        </button>
                      </div>
                      <small>üîí Sua chave √© armazenada de forma criptografada localmente.</small>
                    </div>

                    <div>
                      <label for="custom-model-status">Status do Modelo:</label>
                      <div class="model-status" id="custom-model-status">
                        <span class="status-badge inactive">Inativo</span>
                        <button class="btn-activate" data-model="google">Ativar</button>
                      </div>
                    </div>
                  </div>

                  <!-- üî• NOVO: Campo de modelo de transcri√ß√£o -->
                  <div class="form-group">
                    <label for="google-stt-model">Modelo de Transcri√ß√£o (STT):</label>
                    <select id="google-stt-model" class="interactive-zone">
                      <option value="deepgram">Deepgram (Nuvem, Tempo Real)</option>
                      <option value="vosk">Vosk (R√°pido)</option>
                      <option value="whisper-cpp-local">Whisper.cpp (Alta Precis√£o)</option>
                    </select>
                    <small
                      >Escolha entre transcri√ß√£o r√°pida (Vosk), offline (Whisper.cpp) ou nuvem
                      (Deepgram).</small
                    >
                  </div>

                  <!-- üî• MODIFICADO: Campo de modelo de resposta -->
                  <div class="form-group">
                    <label for="google-llm-model">Modelo de Resposta:</label>
                    <select id="google-llm-model" class="interactive-zone">
                      <option value="gemini-pro">Gemini Pro</option>
                    </select>
                    <small>Selecione o modelo Gemini para gerar respostas.</small>
                  </div>

                  <div class="action-buttons">
                    <button class="btn-save" data-section="google">
                      <span class="material-icons">save</span>
                      Salvar Configura√ß√µes
                    </button>
                  </div>
                </div>
              </div>

              <!-- OpenRouter Tab -->
              <div id="openrouter" class="tab-pane">
                <div class="config-form">
                  <div class="form-group flex space-between">
                    <div>
                      <label for="openrouter-api-key">Chave da API:</label>
                      <div class="input-with-action">
                        <input
                          type="password"
                          id="openrouter-api-key"
                          placeholder="Insira sua API key"
                          class="api-key-input"
                          autocomplete="off"
                          data-has-key="false"
                        />
                        <button class="btn-toggle-visibility" data-target="openrouter-api-key">
                          <span class="material-icons">visibility</span>
                        </button>
                        <!-- üî• NOVO: Bot√£o para deletar API key -->
                        <button
                          class="btn-delete-api-key"
                          data-provider="openrouter"
                          title="Remover API key"
                        >
                          <span class="material-icons">delete</span>
                        </button>
                      </div>
                      <small>üîí Sua chave √© armazenada de forma criptografada localmente.</small>
                    </div>

                    <div>
                      <label for="openrouter-model-status">Status do Modelo:</label>
                      <div class="model-status" id="openrouter-model-status">
                        <span class="status-badge inactive">Inativo</span>
                        <button class="btn-activate" data-model="openrouter">Ativar</button>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="openrouter-stt-model">Modelo de Transcri√ß√£o (STT):</label>
                    <select id="openrouter-stt-model" class="interactive-zone">
                      <option value="deepgram">Deepgram (Nuvem, Tempo Real)</option>
                      <option value="vosk">Vosk (R√°pido)</option>
                      <option value="whisper-cpp-local">Whisper.cpp (Alta Precis√£o)</option>
                      <option value="whisper-1">Whisper-1 (OpenAI/Nuvem)</option>
                    </select>
                    <small>Escolha entre transcri√ß√£o r√°pida (Vosk) ou nuvem (Whisper-1)</small>
                  </div>

                  <div class="form-group">
                    <label for="openrouter-llm-model">Modelo de Resposta:</label>
                    <select id="openrouter-llm-model" class="interactive-zone">
                      <option value="">-- Selecione um modelo --</option>
                    </select>
                    <small>Configure o modelo para gerar respostas via OpenRouter.</small>
                  </div>

                  <div class="action-buttons">
                    <button class="btn-save" data-section="openrouter">
                      <span class="material-icons">save</span>
                      Salvar Configura√ß√µes
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- √Åudio e Tela -->
        <section id="audio-screen" class="config-section">
          <h2>
            <span class="material-icons">mic</span>
            √Åudio e Tela
          </h2>

          <div class="config-tabs">
            <div class="tab-buttons">
              <button class="tab-button active" data-tab="audio-config">√Åudio</button>
              <button class="tab-button" data-tab="screen-config">Captura de Tela</button>
            </div>

            <div class="tab-content">
              <div id="audio-config" class="tab-pane active">
                <div class="config-form">
                  <!-- üé§ SELE√á√ÉO DE DISPOSITIVO DE ENTRADA -->
                  <div class="form-group">
                    <label for="audio-input-device">Dispositivo de Entrada (Microfone):</label>
                    <select id="audio-input-device" class="device-select"></select>
                    <small>Selecione o microfone ou fonte de √°udio para captura de entrada.</small>
                  </div>

                  <!-- üìä VU METER DE ENTRADA -->
                  <div class="form-group">
                    <label for="inputVu">N√≠vel de Volume (Entrada):</label>
                    <div class="vu-meter">
                      <div id="inputVu" class="vu-fill"></div>
                    </div>
                    <small>Indicador visual do volume capturado pelo dispositivo de entrada.</small>
                  </div>

                  <!-- üîä SELE√á√ÉO DE DISPOSITIVO DE SA√çDA -->
                  <div class="form-group">
                    <label for="audio-output-device"
                      >Dispositivo de Sa√≠da (VoiceMeeter/Output):</label
                    >
                    <select id="audio-output-device" class="device-select"></select>
                    <small>
                      Selecione a fonte de √°udio de sa√≠da (ex: VoiceMeeter Output) para monitorar
                      outros participantes.
                    </small>
                  </div>

                  <!-- üìä VU METER DE SA√çDA -->
                  <div class="form-group">
                    <label for="outputVu">N√≠vel de Volume (Sa√≠da):</label>
                    <div class="vu-meter">
                      <div id="outputVu" class="vu-fill"></div>
                    </div>
                    <small>Indicador visual do volume capturado do dispositivo de sa√≠da.</small>
                  </div>
                </div>
              </div>

              <div id="screen-config" class="tab-pane">
                <div class="config-form">
                  <div class="form-group">
                    <label for="screenshot-hotkey">Atalho para Screenshot:</label>
                    <input
                      type="text"
                      id="screenshot-hotkey"
                      value="Ctrl+Shift+S"
                      readonly
                      class="hotkey-input"
                    />
                    <button id="recordHotkeyBtn" class="btn-record-hotkey">Gravar Atalho</button>
                  </div>

                  <div class="form-group">
                    <label>
                      <input type="checkbox" id="exclude-app-from-screenshot" />
                      Excluir esta aplica√ß√£o das capturas de tela
                    </label>
                    <small
                      >Quando ativado, o app ser√° invis√≠vel para screenshots de outros
                      aplicativos.</small
                    >
                  </div>

                  <div class="form-group">
                    <label for="screenshot-format">Formato da Imagem:</label>
                    <select id="screenshot-format">
                      <option value="png">PNG (maior qualidade)</option>
                      <option value="jpg">JPG (menor tamanho)</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Privacidade -->
        <section id="privacy" class="config-section">
          <h2>
            <span class="material-icons">security</span>
            Privacidade
          </h2>

          <div class="config-form">
            <div class="form-group">
              <label>
                <input type="checkbox" id="hide-from-screen-capture" />
                Ocultar aplicativo de capturas de tela
              </label>
              <small>Quando ativado, outras aplica√ß√µes n√£o conseguir√£o capturar esta janela.</small>
            </div>

            <div class="form-group">
              <label>
                <input type="checkbox" id="disable-telemetry" />
                Desativar telemetria an√¥nima
              </label>
              <small>Impede o envio de dados de uso para melhorias no produto.</small>
            </div>

            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-clear-data" />
                Limpar dados automaticamente ao fechar
              </label>
              <small>Remove √°udios e transcri√ß√µes tempor√°rias ao encerrar o app.</small>
            </div>

            <div class="form-group">
              <label for="data-retention-days">Reten√ß√£o de Dados:</label>
              <select id="data-retention-days">
                <option value="1">1 dia</option>
                <option value="7" selected>7 dias</option>
                <option value="30">30 dias</option>
                <option value="0">Nunca excluir</option>
              </select>
            </div>

            <button class="btn-save" data-section="privacy">
              <span class="material-icons">save</span>
              Salvar Configura√ß√µes de Privacidade
            </button>
          </div>
        </section>

        <!-- Outros -->
        <section id="other" class="config-section">
          <h2>
            <span class="material-icons">more_horiz</span>
            Outras Configura√ß√µes
          </h2>

          <div class="config-form">
            <div class="form-group form-group-flex">
              <!-- üåô TOGGLE DARK MODE -->
              <div class="controls-mock interactive-zone">
                <label class="switch">
                  <span class="switch-label">Dark Mode</span>
                  <div class="switch-control">
                    <input type="checkbox" id="darkModeToggle" />
                    <span class="slider"></span>
                  </div>
                </label>
              </div>

              <!-- Modo Mock -->
              <div class="controls-mock interactive-zone">
                <label class="switch">
                  <span class="switch-label">Modo Mock</span>
                  <div class="switch-control">
                    <input type="checkbox" id="mockToggle" />
                    <span class="slider"></span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label for="language">Idioma da Interface:</label>
              <select id="language">
                <option value="pt-BR" selected>Portugu√™s (Brasil)</option>
                <option value="en-US">English (US)</option>
                <option value="es-ES">Espa√±ol</option>
              </select>
            </div>

            <div class="form-group">
              <label>
                <input type="checkbox" id="auto-update" />
                Buscar atualiza√ß√µes automaticamente
              </label>
            </div>

            <div class="form-group">
              <label for="log-level">N√≠vel de Log:</label>
              <select id="log-level">
                <option value="error">Somente erros</option>
                <option value="warn">Avisos e erros</option>
                <option value="info" selected>Informacional</option>
                <option value="debug">Debug (detalhado)</option>
              </select>
            </div>

            <div class="form-group danger-zone">
              <label for="btn-reset-config"
                >‚ö†Ô∏è Restaure as configura√ß√µes padr√£o (de f√°brica) do APP.</label
              >
              <button
                class="btn-reset-config danger"
                id="btn-reset-config"
                title="Restaurar todas as configura√ß√µes ao padr√£o"
              >
                üîÑ Restaurar Configura√ß√µes de F√°brica
              </button>
            </div>
          </div>
        </section>

        <!-- Info -->
        <section id="info" class="config-section">
          <h2>
            <span class="material-icons">info</span>
            Info
          </h2>

          <div class="config-form">
            <div class="form-group"></div>
          </div>
        </section>
      </div>
    </div>

    <!-- ==================== UTILIDADES ==================== -->
    <script src="./utils/constants.js"></script>
    <script src="./utils/Logger.js"></script>
    <script src="./utils/ErrorHandler.js"></script>
    <script src="./utils/SecureLogger.js"></script>

    <!-- ==================== INFRAESTRUTURA ==================== -->
    <!-- Estado central e bus de eventos -->
    <script src="./infra/state/AppState.js"></script>
    <script src="./infra/bus/EventBus.js"></script>

    <!-- ==================== SERVICES (Orquestradores & Adapters) ==================== -->
    <!-- STT Service -->
    <script src="./services/stt/STTStrategy.js"></script>
    <script src="./services/stt/stt-deepgram.js"></script>
    <script src="./services/stt/stt-vosk.js"></script>
    <script src="./services/stt/stt-whisper.js"></script>

    <!-- LLM Service -->
    <script src="./services/llm/LLMManager.js"></script>
    <script src="./services/llm/handlers/openai-handler.js"></script>
    <script src="./services/llm/handlers/gemini-handler.js"></script>
    <script src="./services/llm/llmHandlers.js"></script>

    <!-- Audio Service -->
    <script src="./services/audio/volume-audio-monitor.js"></script>

    <!-- ==================== UTILS DOM E HELPERS ==================== -->
    <script src="./utils/DOM-Registry.js"></script>
    <script src="./utils/renderer-helpers.js"></script>

    <!-- ==================== CONTROLLERS (L√≥gica pura - GLOBAL) ==================== -->
    <script src="./controllers/global/audio/audio-controller.js"></script>
    <script src="./controllers/global/modes/mode-manager.js"></script>

    <!-- ==================== SECTIONS (UI Controllers & Managers) ==================== -->
    <!-- HOME Section -->
    <script src="./controllers/sections/home/question-helpers.js"></script>
    <script src="./controllers/sections/home/question-controller.js"></script>
    <script src="./controllers/sections/home/screenshot-controller.js"></script>
    <script src="./controllers/sections/home/HomeUIManager.js"></script>

    <!-- TOP BAR Section -->
    <script src="./controllers/sections/top-bar/TopBarManager.js"></script>

    <!-- API & MODELOS Section -->
    <script src="./controllers/sections/api-models/ApiKeyManager.js"></script>
    <script src="./controllers/sections/api-models/ModelSelectionManager.js"></script>

    <!-- √ÅUDIO & TELA Section -->
    <script src="./controllers/sections/audio-screen/AudioDeviceManager.js"></script>
    <script src="./controllers/sections/audio-screen/ScreenConfigManager.js"></script>

    <!-- PRIVACIDADE Section -->
    <script src="./controllers/sections/privacy/PrivacyConfigManager.js"></script>

    <!-- OUTROS Section -->
    <script src="./controllers/sections/others/OtherConfigManager.js"></script>

    <!-- INFO Section -->
    <script src="./controllers/sections/info/InfoManager.js"></script>

    <!-- WINDOW Section -->
    <script src="./controllers/sections/window/WindowUIManager.js"></script>

    <!-- ==================== REGISTRIES (Orquestra√ß√£o de Servi√ßos) ==================== -->
    <script src="./services/stt/stt-registry.js"></script>
    <script src="./controllers/modes/modes-registry.js"></script>
    <script src="./services/llm/llm-registry.js"></script>
    <script src="./services/llm/system-prompt.js"></script>

    <!-- ==================== LLM CONTROLLER (L√≥gica de Requisi√ß√£o LLM) ==================== -->
    <script src="./controllers/llm/llm-controller.js"></script>

    <!-- ==================== CONFIG MANAGER (Orquestrador) ==================== -->
    <script src="./controllers/config/ConfigManager.js"></script>

    <!-- ==================== RENDERER (Orquestra√ß√£o & RendererAPI) ==================== -->
    <script src="./renderer.js"></script>

    <!-- ==================== INICIALIZA√á√ÉO ==================== -->
    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        console.log('üìñ DOMContentLoaded - Inicializando aplica√ß√£o...');
        try {
          // Registrar todos os elementos DOM no registry
          if (globalThis.DOM && typeof globalThis.DOM.register === 'function') {
            globalThis.DOM.register();
            console.log('‚úÖ DOM Registry inicializado');
          }

          // Aguarda RendererAPI estar dispon√≠vel
          let attempts = 0;
          while (!globalThis.RendererAPI && attempts < 50) {
            await new Promise((resolve) => setTimeout(resolve, 100));
            attempts++;
          }

          if (!globalThis.RendererAPI) {
            console.error('‚ùå RendererAPI n√£o foi carregado ap√≥s timeout');
            return;
          }

          // ConfigManager orquestra todos os managers
          globalThis.configManager = new ConfigManager();
          await globalThis.configManager.initializeController();
          console.log('‚úÖ ConfigManager inicializado com sucesso');

          // ==========================================
          // INICIALIZAR AUDIO CONTROLLER COM DEPEND√äNCIAS
          // ==========================================
          if (globalThis.RendererAPI?.initAudioController) {
            // üî• Popula UIElements com seletores reais do DOM
            const uiElements = {
              inputSelect: document.getElementById('audio-input-device'),
              outputSelect: document.getElementById('audio-output-device'),
              listeningBtn: document.getElementById('listening-btn'),
              listenBtn: document.getElementById('listen-btn'),
            };

            const audioControllerDeps = {
              appState: globalThis.appState,
              eventBus: globalThis.eventBus,
              sttStrategy: globalThis.RendererAPI.sttStrategy,
              globalConfig: globalThis.configManager,
              UIElements: uiElements, // ‚úÖ Agora com seletores reais
              CURRENT_QUESTION_ID: 'CURRENT',
              modeManager: globalThis.RendererAPI.modeManager,
              MODES: globalThis.RendererAPI.MODES,
              getConfiguredSTTModel: globalThis.RendererAPI.getConfiguredSTTModel,
              closeCurrentQuestionForced: globalThis.RendererAPI.closeCurrentQuestionForced,
              updateStatusMessage: globalThis.RendererAPI.updateStatusMessage,
              findAnswerByQuestionId: globalThis.RendererAPI.findAnswerByQuestionId,
            };
            globalThis.RendererAPI.initAudioController(audioControllerDeps);
            console.log('‚úÖ AudioController inicializado com sucesso');
          }

          console.log('‚úÖ Aplica√ß√£o inicializada com sucesso');
        } catch (error) {
          console.error('‚ùå Erro ao inicializar aplica√ß√£o:', error);
          if (globalThis.Logger) {
            globalThis.Logger.error('Erro ao inicializar', error);
          }
        }
      });
    </script>
  </body>
</html>
